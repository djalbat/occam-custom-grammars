"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = void 0;
var _necessary = require("necessary");
var _defaultCustomGrammar = _interopRequireDefault(require("./defaultCustomGrammar"));
var _constants = require("./constants");
var _rules = require("./utilities/rules");
var _ruleName = require("./utilities/ruleName");
var _customGrammars = require("./utilities/customGrammars");
var _ruleNames = require("./ruleNames");
function _arrayLikeToArray(arr, len) {
    if (len == null || len > arr.length) len = arr.length;
    for(var i = 0, arr2 = new Array(len); i < len; i++)arr2[i] = arr[i];
    return arr2;
}
function _arrayWithoutHoles(arr) {
    if (Array.isArray(arr)) return _arrayLikeToArray(arr);
}
function _classCallCheck(instance, Constructor) {
    if (!(instance instanceof Constructor)) {
        throw new TypeError("Cannot call a class as a function");
    }
}
function _defineProperties(target, props) {
    for(var i = 0; i < props.length; i++){
        var descriptor = props[i];
        descriptor.enumerable = descriptor.enumerable || false;
        descriptor.configurable = true;
        if ("value" in descriptor) descriptor.writable = true;
        Object.defineProperty(target, descriptor.key, descriptor);
    }
}
function _createClass(Constructor, protoProps, staticProps) {
    if (protoProps) _defineProperties(Constructor.prototype, protoProps);
    if (staticProps) _defineProperties(Constructor, staticProps);
    return Constructor;
}
function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _iterableToArray(iter) {
    if (typeof Symbol !== "undefined" && iter[Symbol.iterator] != null || iter["@@iterator"] != null) return Array.from(iter);
}
function _nonIterableSpread() {
    throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
}
function _toConsumableArray(arr) {
    return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
}
function _unsupportedIterableToArray(o, minLen) {
    if (!o) return;
    if (typeof o === "string") return _arrayLikeToArray(o, minLen);
    var n = Object.prototype.toString.call(o).slice(8, -1);
    if (n === "Object" && o.constructor) n = o.constructor.name;
    if (n === "Map" || n === "Set") return Array.from(n);
    if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
}
var filter = _necessary.arrayUtilities.filter, unshift = _necessary.arrayUtilities.unshift;
var CombinedCustomGrammar = /*#__PURE__*/ function() {
    function CombinedCustomGrammar(lexicalPattern, rules) {
        _classCallCheck(this, CombinedCustomGrammar);
        this.lexicalPattern = lexicalPattern;
        this.rules = rules;
    }
    _createClass(CombinedCustomGrammar, [
        {
            key: "getLexicalPattern",
            value: function getLexicalPattern() {
                return this.lexicalPattern;
            }
        },
        {
            key: "getRules",
            value: function getRules() {
                return this.rules;
            }
        }
    ], [
        {
            key: "fromCustomGrammars",
            value: function fromCustomGrammars(customGrammars) {
                var metastatementRules = metastatementRulesFromCustomGrammarsAndDefaultBNF(customGrammars), statementRules = statementRulesFromCustomGrammarsAndDefaultBNF(customGrammars), expressionRules = expressionRulesFromCustomGrammarsAndDefaultBNF(customGrammars), termRules = termRulesFromCustomGrammarsAndDefaultBNF(customGrammars), lexicalPattern = lexicalPatternFromCustomGrammars(customGrammars), rules = _toConsumableArray(metastatementRules).concat(_toConsumableArray(statementRules), _toConsumableArray(expressionRules), _toConsumableArray(termRules));
                var combinedCustomGrammar = new CombinedCustomGrammar(lexicalPattern, rules);
                return combinedCustomGrammar;
            }
        }
    ]);
    return CombinedCustomGrammar;
}();
exports.default = CombinedCustomGrammar;
function metastatementRulesFromCustomGrammarsAndDefaultBNF(customGrammars) {
    var metastatementRuleName = _ruleNames.METASTATEMENT_RULE_NAME, metastatementRules = rulesFromRuleNameCustomGrammarsAndDefaultBNF(metastatementRuleName, customGrammars);
    return metastatementRules;
}
function statementRulesFromCustomGrammarsAndDefaultBNF(customGrammars) {
    var statementRuleName = _ruleNames.STATEMENT_RULE_NAME, statementRules = rulesFromRuleNameCustomGrammarsAndDefaultBNF(statementRuleName, customGrammars);
    return statementRules;
}
function expressionRulesFromCustomGrammarsAndDefaultBNF(customGrammars) {
    var expressionRuleName = _ruleNames.EXPRESSION_RULE_NAME, expressionRules = rulesFromRuleNameCustomGrammarsAndDefaultBNF(expressionRuleName, customGrammars);
    return expressionRules;
}
function termRulesFromCustomGrammarsAndDefaultBNF(customGrammars) {
    var termRuleName = _ruleNames.TERM_RULE_NAME, termRules = rulesFromRuleNameCustomGrammarsAndDefaultBNF(termRuleName, customGrammars);
    return termRules;
}
function lexicalPatternFromCustomGrammars(customGrammars) {
    var lexicalPatterns = (0, _customGrammars).lexicalPatternsFromCustomGrammars(customGrammars), defaultCustomGrammarLexicalPattern = _defaultCustomGrammar.default.getLexicalPattern(), defaultLexicalPattern = defaultCustomGrammarLexicalPattern; ///
    lexicalPatterns.reverse();
    lexicalPatterns.push(defaultLexicalPattern);
    filter(lexicalPatterns, function(lexicalPattern) {
        if (lexicalPattern !== _constants.EMPTY_STRING) {
            return true;
        }
    });
    var lexicalPatternsString = lexicalPatterns.join("|"), lexicalPattern1 = "^(?:".concat(lexicalPatternsString, ")");
    return lexicalPattern1;
}
function remainingRulesFromRulesAndMainRule(rules, mainRule) {
    var remainingRules = rules.filter(function(rule) {
        if (rule !== mainRule) {
            return true;
        }
    });
    return remainingRules;
}
function mainRuleFromRuleNameDefaultBNFAndBNFs(ruleName, bnfs) {
    var defaultCustomGrammarBNF = _defaultCustomGrammar.default.getBNF(ruleName), defaultBNF = defaultCustomGrammarBNF, defaultRules = (0, _rules).rulesFromBNF(defaultBNF), defaultMainRule = (0, _ruleName).findRuleByRuleName(ruleName, defaultRules), defaultMainRuleDefinitions = defaultMainRule.getDefinitions();
    bnfs.forEach(function(bnf) {
        var rules = (0, _rules).rulesFromBNF(bnf), mainRule = (0, _ruleName).findRuleByRuleName(ruleName, rules), mainRuleDefinitions = mainRule !== null ? mainRule.getDefinitions() : [];
        unshift(defaultMainRuleDefinitions, mainRuleDefinitions);
    });
    var mainRule1 = defaultMainRule; ///
    return mainRule1;
}
function remainingRulesFromRuleNameDefaultBNFAndBNFs(ruleName, bnfs) {
    var defaultCustomGrammarBNF = _defaultCustomGrammar.default.getBNF(ruleName), defaultBNF = defaultCustomGrammarBNF, defaultRules = (0, _rules).rulesFromBNF(defaultBNF), defaultMainRule = (0, _ruleName).findRuleByRuleName(ruleName, defaultRules), defaultRemainingRules = remainingRulesFromRulesAndMainRule(defaultRules, defaultMainRule);
    bnfs.forEach(function(bnf) {
        var rules = (0, _rules).rulesFromBNF(bnf), mainRule = (0, _ruleName).findRuleByRuleName(ruleName, rules), remainingRules = remainingRulesFromRulesAndMainRule(rules, mainRule);
        unshift(defaultRemainingRules, remainingRules);
    });
    var remainingRules1 = defaultRemainingRules; ///
    return remainingRules1;
}
function rulesFromRuleNameCustomGrammarsAndDefaultBNF(ruleName, customGrammars) {
    var bnfs = (0, _customGrammars).bnfsFromRuleNameAndCustomGrammars(ruleName, customGrammars), mainRule = mainRuleFromRuleNameDefaultBNFAndBNFs(ruleName, bnfs), remainingRules = remainingRulesFromRuleNameDefaultBNFAndBNFs(ruleName, bnfs), rules = [].concat(mainRule).concat(remainingRules);
    return rules;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jb21iaW5lZEN1c3RvbUdyYW1tYXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbmltcG9ydCB7IGFycmF5VXRpbGl0aWVzIH0gZnJvbSBcIm5lY2Vzc2FyeVwiO1xuXG5pbXBvcnQgZGVmYXVsdEN1c3RvbUdyYW1tYXIgZnJvbSBcIi4vZGVmYXVsdEN1c3RvbUdyYW1tYXJcIjtcblxuaW1wb3J0IHsgRU1QVFlfU1RSSU5HIH0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBydWxlc0Zyb21CTkYgfSBmcm9tIFwiLi91dGlsaXRpZXMvcnVsZXNcIjtcbmltcG9ydCB7IGZpbmRSdWxlQnlSdWxlTmFtZSB9IGZyb20gXCIuL3V0aWxpdGllcy9ydWxlTmFtZVwiO1xuaW1wb3J0IHsgbGV4aWNhbFBhdHRlcm5zRnJvbUN1c3RvbUdyYW1tYXJzLCBibmZzRnJvbVJ1bGVOYW1lQW5kQ3VzdG9tR3JhbW1hcnMgfSBmcm9tIFwiLi91dGlsaXRpZXMvY3VzdG9tR3JhbW1hcnNcIjtcbmltcG9ydCB7IFRFUk1fUlVMRV9OQU1FLCBFWFBSRVNTSU9OX1JVTEVfTkFNRSwgU1RBVEVNRU5UX1JVTEVfTkFNRSwgTUVUQVNUQVRFTUVOVF9SVUxFX05BTUUgfSBmcm9tIFwiLi9ydWxlTmFtZXNcIjtcblxuY29uc3QgeyBmaWx0ZXIsIHVuc2hpZnQgfSA9IGFycmF5VXRpbGl0aWVzO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21iaW5lZEN1c3RvbUdyYW1tYXIge1xuICBjb25zdHJ1Y3RvcihsZXhpY2FsUGF0dGVybiwgcnVsZXMpIHtcbiAgICB0aGlzLmxleGljYWxQYXR0ZXJuID0gbGV4aWNhbFBhdHRlcm47XG4gICAgdGhpcy5ydWxlcyA9IHJ1bGVzO1xuICB9XG4gIFxuICBnZXRMZXhpY2FsUGF0dGVybigpIHtcbiAgICByZXR1cm4gdGhpcy5sZXhpY2FsUGF0dGVybjtcbiAgfVxuXG4gIGdldFJ1bGVzKCkge1xuICAgIHJldHVybiB0aGlzLnJ1bGVzO1xuICB9XG5cbiAgc3RhdGljIGZyb21DdXN0b21HcmFtbWFycyhjdXN0b21HcmFtbWFycykge1xuICAgIGNvbnN0IG1ldGFzdGF0ZW1lbnRSdWxlcyA9IG1ldGFzdGF0ZW1lbnRSdWxlc0Zyb21DdXN0b21HcmFtbWFyc0FuZERlZmF1bHRCTkYoY3VzdG9tR3JhbW1hcnMpLFxuICAgICAgICAgIHN0YXRlbWVudFJ1bGVzID0gc3RhdGVtZW50UnVsZXNGcm9tQ3VzdG9tR3JhbW1hcnNBbmREZWZhdWx0Qk5GKGN1c3RvbUdyYW1tYXJzKSxcbiAgICAgICAgICBleHByZXNzaW9uUnVsZXMgPSBleHByZXNzaW9uUnVsZXNGcm9tQ3VzdG9tR3JhbW1hcnNBbmREZWZhdWx0Qk5GKGN1c3RvbUdyYW1tYXJzKSxcbiAgICAgICAgICB0ZXJtUnVsZXMgPSB0ZXJtUnVsZXNGcm9tQ3VzdG9tR3JhbW1hcnNBbmREZWZhdWx0Qk5GKGN1c3RvbUdyYW1tYXJzKSxcbiAgICAgICAgICBsZXhpY2FsUGF0dGVybiA9IGxleGljYWxQYXR0ZXJuRnJvbUN1c3RvbUdyYW1tYXJzKGN1c3RvbUdyYW1tYXJzKSxcbiAgICAgICAgICBydWxlcyA9IFtcbiAgICAgICAgICAgIC4uLm1ldGFzdGF0ZW1lbnRSdWxlcyxcbiAgICAgICAgICAgIC4uLnN0YXRlbWVudFJ1bGVzLFxuICAgICAgICAgICAgLi4uZXhwcmVzc2lvblJ1bGVzLFxuICAgICAgICAgICAgLi4udGVybVJ1bGVzXG4gICAgICAgICAgXTtcblxuICAgIGNvbnN0IGNvbWJpbmVkQ3VzdG9tR3JhbW1hciA9IG5ldyBDb21iaW5lZEN1c3RvbUdyYW1tYXIobGV4aWNhbFBhdHRlcm4sIHJ1bGVzKTtcbiAgICBcbiAgICByZXR1cm4gY29tYmluZWRDdXN0b21HcmFtbWFyO1xuICB9XG59XG5cbmZ1bmN0aW9uIG1ldGFzdGF0ZW1lbnRSdWxlc0Zyb21DdXN0b21HcmFtbWFyc0FuZERlZmF1bHRCTkYoY3VzdG9tR3JhbW1hcnMpIHtcbiAgY29uc3QgbWV0YXN0YXRlbWVudFJ1bGVOYW1lID0gTUVUQVNUQVRFTUVOVF9SVUxFX05BTUUsICAvLy9cbiAgICAgICAgbWV0YXN0YXRlbWVudFJ1bGVzID0gcnVsZXNGcm9tUnVsZU5hbWVDdXN0b21HcmFtbWFyc0FuZERlZmF1bHRCTkYobWV0YXN0YXRlbWVudFJ1bGVOYW1lLCBjdXN0b21HcmFtbWFycyk7XG5cbiAgcmV0dXJuIG1ldGFzdGF0ZW1lbnRSdWxlcztcbn1cblxuZnVuY3Rpb24gc3RhdGVtZW50UnVsZXNGcm9tQ3VzdG9tR3JhbW1hcnNBbmREZWZhdWx0Qk5GKGN1c3RvbUdyYW1tYXJzKSB7XG4gIGNvbnN0IHN0YXRlbWVudFJ1bGVOYW1lID0gU1RBVEVNRU5UX1JVTEVfTkFNRSwgIC8vL1xuICAgICAgICBzdGF0ZW1lbnRSdWxlcyA9IHJ1bGVzRnJvbVJ1bGVOYW1lQ3VzdG9tR3JhbW1hcnNBbmREZWZhdWx0Qk5GKHN0YXRlbWVudFJ1bGVOYW1lLCBjdXN0b21HcmFtbWFycyk7XG5cbiAgcmV0dXJuIHN0YXRlbWVudFJ1bGVzO1xufVxuXG5mdW5jdGlvbiBleHByZXNzaW9uUnVsZXNGcm9tQ3VzdG9tR3JhbW1hcnNBbmREZWZhdWx0Qk5GKGN1c3RvbUdyYW1tYXJzKSB7XG4gIGNvbnN0IGV4cHJlc3Npb25SdWxlTmFtZSA9IEVYUFJFU1NJT05fUlVMRV9OQU1FLCAgLy8vXG4gICAgICAgIGV4cHJlc3Npb25SdWxlcyA9IHJ1bGVzRnJvbVJ1bGVOYW1lQ3VzdG9tR3JhbW1hcnNBbmREZWZhdWx0Qk5GKGV4cHJlc3Npb25SdWxlTmFtZSwgY3VzdG9tR3JhbW1hcnMpO1xuXG4gIHJldHVybiBleHByZXNzaW9uUnVsZXM7XG59XG5cbmZ1bmN0aW9uIHRlcm1SdWxlc0Zyb21DdXN0b21HcmFtbWFyc0FuZERlZmF1bHRCTkYoY3VzdG9tR3JhbW1hcnMpIHtcbiAgY29uc3QgdGVybVJ1bGVOYW1lID0gVEVSTV9SVUxFX05BTUUsICAvLy9cbiAgICAgICAgdGVybVJ1bGVzID0gcnVsZXNGcm9tUnVsZU5hbWVDdXN0b21HcmFtbWFyc0FuZERlZmF1bHRCTkYodGVybVJ1bGVOYW1lLCBjdXN0b21HcmFtbWFycyk7XG5cbiAgcmV0dXJuIHRlcm1SdWxlcztcbn1cblxuZnVuY3Rpb24gbGV4aWNhbFBhdHRlcm5Gcm9tQ3VzdG9tR3JhbW1hcnMoY3VzdG9tR3JhbW1hcnMpIHtcbiAgY29uc3QgbGV4aWNhbFBhdHRlcm5zID0gbGV4aWNhbFBhdHRlcm5zRnJvbUN1c3RvbUdyYW1tYXJzKGN1c3RvbUdyYW1tYXJzKSxcbiAgICAgICAgZGVmYXVsdEN1c3RvbUdyYW1tYXJMZXhpY2FsUGF0dGVybiA9IGRlZmF1bHRDdXN0b21HcmFtbWFyLmdldExleGljYWxQYXR0ZXJuKCksXG4gICAgICAgIGRlZmF1bHRMZXhpY2FsUGF0dGVybiA9IGRlZmF1bHRDdXN0b21HcmFtbWFyTGV4aWNhbFBhdHRlcm47IC8vL1xuXG4gIGxleGljYWxQYXR0ZXJucy5yZXZlcnNlKCk7XG5cbiAgbGV4aWNhbFBhdHRlcm5zLnB1c2goZGVmYXVsdExleGljYWxQYXR0ZXJuKTtcblxuICBmaWx0ZXIobGV4aWNhbFBhdHRlcm5zLCAobGV4aWNhbFBhdHRlcm4pID0+IHtcbiAgICBpZiAobGV4aWNhbFBhdHRlcm4gIT09IEVNUFRZX1NUUklORykge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBsZXhpY2FsUGF0dGVybnNTdHJpbmcgPSBsZXhpY2FsUGF0dGVybnMuam9pbihcInxcIiksIC8vL1xuICAgICAgICBsZXhpY2FsUGF0dGVybiA9IGBeKD86JHtsZXhpY2FsUGF0dGVybnNTdHJpbmd9KWA7XG5cbiAgcmV0dXJuIGxleGljYWxQYXR0ZXJuO1xufVxuXG5mdW5jdGlvbiByZW1haW5pbmdSdWxlc0Zyb21SdWxlc0FuZE1haW5SdWxlKHJ1bGVzLCBtYWluUnVsZSkge1xuICBjb25zdCByZW1haW5pbmdSdWxlcyA9IHJ1bGVzLmZpbHRlcigocnVsZSkgPT4ge1xuICAgIGlmIChydWxlICE9PSBtYWluUnVsZSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gcmVtYWluaW5nUnVsZXM7XG59XG5cbmZ1bmN0aW9uIG1haW5SdWxlRnJvbVJ1bGVOYW1lRGVmYXVsdEJORkFuZEJORnMocnVsZU5hbWUsIGJuZnMpIHtcbiAgY29uc3QgZGVmYXVsdEN1c3RvbUdyYW1tYXJCTkYgPSBkZWZhdWx0Q3VzdG9tR3JhbW1hci5nZXRCTkYocnVsZU5hbWUpLFxuICAgICAgICBkZWZhdWx0Qk5GID0gZGVmYXVsdEN1c3RvbUdyYW1tYXJCTkYsIC8vL1xuICAgICAgICBkZWZhdWx0UnVsZXMgPSBydWxlc0Zyb21CTkYoZGVmYXVsdEJORiksXG4gICAgICAgIGRlZmF1bHRNYWluUnVsZSA9IGZpbmRSdWxlQnlSdWxlTmFtZShydWxlTmFtZSwgZGVmYXVsdFJ1bGVzKSxcbiAgICAgICAgZGVmYXVsdE1haW5SdWxlRGVmaW5pdGlvbnMgPSBkZWZhdWx0TWFpblJ1bGUuZ2V0RGVmaW5pdGlvbnMoKTtcblxuICBibmZzLmZvckVhY2goKGJuZikgPT4ge1xuICAgIGNvbnN0IHJ1bGVzID0gcnVsZXNGcm9tQk5GKGJuZiksXG4gICAgICAgICAgbWFpblJ1bGUgPSBmaW5kUnVsZUJ5UnVsZU5hbWUocnVsZU5hbWUsIHJ1bGVzKSxcbiAgICAgICAgICBtYWluUnVsZURlZmluaXRpb25zID0gKG1haW5SdWxlICE9PSBudWxsKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFpblJ1bGUuZ2V0RGVmaW5pdGlvbnMoKSA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbXTtcblxuICAgIHVuc2hpZnQoZGVmYXVsdE1haW5SdWxlRGVmaW5pdGlvbnMsIG1haW5SdWxlRGVmaW5pdGlvbnMpO1xuICB9KTtcblxuICBjb25zdCBtYWluUnVsZSA9IGRlZmF1bHRNYWluUnVsZTsgLy8vXG5cbiAgcmV0dXJuIG1haW5SdWxlO1xufVxuXG5mdW5jdGlvbiByZW1haW5pbmdSdWxlc0Zyb21SdWxlTmFtZURlZmF1bHRCTkZBbmRCTkZzKHJ1bGVOYW1lLCBibmZzKSB7XG4gIGNvbnN0IGRlZmF1bHRDdXN0b21HcmFtbWFyQk5GID0gZGVmYXVsdEN1c3RvbUdyYW1tYXIuZ2V0Qk5GKHJ1bGVOYW1lKSxcbiAgICAgICAgZGVmYXVsdEJORiA9IGRlZmF1bHRDdXN0b21HcmFtbWFyQk5GLCAvLy9cbiAgICAgICAgZGVmYXVsdFJ1bGVzID0gcnVsZXNGcm9tQk5GKGRlZmF1bHRCTkYpLFxuICAgICAgICBkZWZhdWx0TWFpblJ1bGUgPSBmaW5kUnVsZUJ5UnVsZU5hbWUocnVsZU5hbWUsIGRlZmF1bHRSdWxlcyksXG4gICAgICAgIGRlZmF1bHRSZW1haW5pbmdSdWxlcyA9IHJlbWFpbmluZ1J1bGVzRnJvbVJ1bGVzQW5kTWFpblJ1bGUoZGVmYXVsdFJ1bGVzLCBkZWZhdWx0TWFpblJ1bGUpO1xuXG4gIGJuZnMuZm9yRWFjaCgoYm5mKSA9PiB7XG4gICAgY29uc3QgcnVsZXMgPSBydWxlc0Zyb21CTkYoYm5mKSxcbiAgICAgICAgICBtYWluUnVsZSA9IGZpbmRSdWxlQnlSdWxlTmFtZShydWxlTmFtZSwgcnVsZXMpLFxuICAgICAgICAgIHJlbWFpbmluZ1J1bGVzID0gcmVtYWluaW5nUnVsZXNGcm9tUnVsZXNBbmRNYWluUnVsZShydWxlcywgbWFpblJ1bGUpO1xuXG4gICAgdW5zaGlmdChkZWZhdWx0UmVtYWluaW5nUnVsZXMsIHJlbWFpbmluZ1J1bGVzKTtcbiAgfSk7XG5cbiAgY29uc3QgcmVtYWluaW5nUnVsZXMgPSBkZWZhdWx0UmVtYWluaW5nUnVsZXM7IC8vL1xuXG4gIHJldHVybiByZW1haW5pbmdSdWxlcztcbn1cblxuZnVuY3Rpb24gcnVsZXNGcm9tUnVsZU5hbWVDdXN0b21HcmFtbWFyc0FuZERlZmF1bHRCTkYocnVsZU5hbWUsIGN1c3RvbUdyYW1tYXJzKSB7XG4gIGNvbnN0IGJuZnMgPSBibmZzRnJvbVJ1bGVOYW1lQW5kQ3VzdG9tR3JhbW1hcnMocnVsZU5hbWUsIGN1c3RvbUdyYW1tYXJzKSxcbiAgICAgICAgbWFpblJ1bGUgPSBtYWluUnVsZUZyb21SdWxlTmFtZURlZmF1bHRCTkZBbmRCTkZzKHJ1bGVOYW1lLCBibmZzKSxcbiAgICAgICAgcmVtYWluaW5nUnVsZXMgPSByZW1haW5pbmdSdWxlc0Zyb21SdWxlTmFtZURlZmF1bHRCTkZBbmRCTkZzKHJ1bGVOYW1lLCBibmZzKSxcbiAgICAgICAgcnVsZXMgPSBbXS5jb25jYXQobWFpblJ1bGUpLmNvbmNhdChyZW1haW5pbmdSdWxlcyk7XG5cbiAgcmV0dXJuIHJ1bGVzO1xufVxuIl0sIm5hbWVzIjpbImZpbHRlciIsImFycmF5VXRpbGl0aWVzIiwidW5zaGlmdCIsIkNvbWJpbmVkQ3VzdG9tR3JhbW1hciIsImxleGljYWxQYXR0ZXJuIiwicnVsZXMiLCJnZXRMZXhpY2FsUGF0dGVybiIsImdldFJ1bGVzIiwiZnJvbUN1c3RvbUdyYW1tYXJzIiwiY3VzdG9tR3JhbW1hcnMiLCJtZXRhc3RhdGVtZW50UnVsZXMiLCJtZXRhc3RhdGVtZW50UnVsZXNGcm9tQ3VzdG9tR3JhbW1hcnNBbmREZWZhdWx0Qk5GIiwic3RhdGVtZW50UnVsZXMiLCJzdGF0ZW1lbnRSdWxlc0Zyb21DdXN0b21HcmFtbWFyc0FuZERlZmF1bHRCTkYiLCJleHByZXNzaW9uUnVsZXMiLCJleHByZXNzaW9uUnVsZXNGcm9tQ3VzdG9tR3JhbW1hcnNBbmREZWZhdWx0Qk5GIiwidGVybVJ1bGVzIiwidGVybVJ1bGVzRnJvbUN1c3RvbUdyYW1tYXJzQW5kRGVmYXVsdEJORiIsImxleGljYWxQYXR0ZXJuRnJvbUN1c3RvbUdyYW1tYXJzIiwiY29tYmluZWRDdXN0b21HcmFtbWFyIiwibWV0YXN0YXRlbWVudFJ1bGVOYW1lIiwiTUVUQVNUQVRFTUVOVF9SVUxFX05BTUUiLCJydWxlc0Zyb21SdWxlTmFtZUN1c3RvbUdyYW1tYXJzQW5kRGVmYXVsdEJORiIsInN0YXRlbWVudFJ1bGVOYW1lIiwiU1RBVEVNRU5UX1JVTEVfTkFNRSIsImV4cHJlc3Npb25SdWxlTmFtZSIsIkVYUFJFU1NJT05fUlVMRV9OQU1FIiwidGVybVJ1bGVOYW1lIiwiVEVSTV9SVUxFX05BTUUiLCJsZXhpY2FsUGF0dGVybnMiLCJsZXhpY2FsUGF0dGVybnNGcm9tQ3VzdG9tR3JhbW1hcnMiLCJkZWZhdWx0Q3VzdG9tR3JhbW1hckxleGljYWxQYXR0ZXJuIiwiZGVmYXVsdEN1c3RvbUdyYW1tYXIiLCJkZWZhdWx0TGV4aWNhbFBhdHRlcm4iLCJyZXZlcnNlIiwicHVzaCIsIkVNUFRZX1NUUklORyIsImxleGljYWxQYXR0ZXJuc1N0cmluZyIsImpvaW4iLCJyZW1haW5pbmdSdWxlc0Zyb21SdWxlc0FuZE1haW5SdWxlIiwibWFpblJ1bGUiLCJyZW1haW5pbmdSdWxlcyIsInJ1bGUiLCJtYWluUnVsZUZyb21SdWxlTmFtZURlZmF1bHRCTkZBbmRCTkZzIiwicnVsZU5hbWUiLCJibmZzIiwiZGVmYXVsdEN1c3RvbUdyYW1tYXJCTkYiLCJnZXRCTkYiLCJkZWZhdWx0Qk5GIiwiZGVmYXVsdFJ1bGVzIiwicnVsZXNGcm9tQk5GIiwiZGVmYXVsdE1haW5SdWxlIiwiZmluZFJ1bGVCeVJ1bGVOYW1lIiwiZGVmYXVsdE1haW5SdWxlRGVmaW5pdGlvbnMiLCJnZXREZWZpbml0aW9ucyIsImZvckVhY2giLCJibmYiLCJtYWluUnVsZURlZmluaXRpb25zIiwicmVtYWluaW5nUnVsZXNGcm9tUnVsZU5hbWVEZWZhdWx0Qk5GQW5kQk5GcyIsImRlZmF1bHRSZW1haW5pbmdSdWxlcyIsImJuZnNGcm9tUnVsZU5hbWVBbmRDdXN0b21HcmFtbWFycyIsImNvbmNhdCJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDOzs7OztBQUVrQixJQUFBLFVBQVcsV0FBWCxXQUFXLENBQUE7QUFFVCxJQUFBLHFCQUF3QixrQ0FBeEIsd0JBQXdCLEVBQUE7QUFFNUIsSUFBQSxVQUFhLFdBQWIsYUFBYSxDQUFBO0FBQ2IsSUFBQSxNQUFtQixXQUFuQixtQkFBbUIsQ0FBQTtBQUNiLElBQUEsU0FBc0IsV0FB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